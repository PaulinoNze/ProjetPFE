<!DOCTYPE html>
<html>
<head>
    <title>Modifier une formation</title>
</head>
<body>
    <h2>Modifier une formation</h2>
    <form action="" method="post">
        <label for="formation">Choisir une formation:</label><br>
        <select name="formation" id="formation">
            <?php
            // Inclusion du fichier de connexion à la base de données
            include '../connexion_bdd.php';

            // Récupération des formations depuis la base de données
            $requete = "SELECT id, titre FROM formations";
            $resultat = $connexion->query($requete);

            // Affichage des formations sous forme de liste déroulante
            while ($row = $resultat->fetch_assoc()) {
                echo "<option value='" . $row['id'] . "'>" . $row['titre'] . "</option>";
            }

            // Libération des résultats et fermeture de la connexion à la base de données
            $resultat->free();
            ?>
        </select><br><br>
        
        <label for="nouveau_titre">Nouveau titre:</label><br>
        <input type="text" id="nouveau_titre" name="nouveau_titre"><br><br>
        
        <input type="submit" value="Modifier la formation" name="submit">
    </form>

    <?php
    if(isset($_POST['submit'])) {
        $formation_id = $_POST['formation'];
        $nouveau_titre = $_POST['nouveau_titre'];

        // Mise à jour du titre de la formation dans la base de données
        $requete_update = "UPDATE formations SET titre='$nouveau_titre' WHERE id=$formation_id";

        if ($connexion->query($requete_update) === TRUE) {
            echo "La formation a été modifiée avec succès!";
        } else {
            echo "Erreur lors de la modification de la formation: " . $connexion->error;
        }
    }

    // Fermeture de la connexion à la base de données
    $connexion->close();
    ?>
</body>
</html>
